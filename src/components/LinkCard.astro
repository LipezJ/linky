---
const { new_link } = Astro.props
---

<script>
	import { Tooltip } from "flowbite"

	import type { InstanceOptions, TooltipOptions } from "flowbite"

	const options: TooltipOptions = {
		placement: "top",
		triggerType: "click",
	}

	const instanceOptions: InstanceOptions = {
		id: "tooltipContent",
		override: true,
	}

	const link = document.getElementById("link")
	const targetElement = document.getElementById("tooltip")
	const triggerElement = document.getElementById("#tooltip-trigger")

	const copyToClipboard = () => {
		if (!targetElement || !triggerElement || !link?.innerText) return
		navigator.clipboard.writeText(link.innerText)
		const tooltip = new Tooltip(targetElement, triggerElement, options, instanceOptions)

		tooltip.show()
	}

	triggerElement?.addEventListener("click", copyToClipboard)
</script>

<div
	class="max-w-full rounded-lg border border-gray-200 bg-white p-6 shadow dark:border-gray-700 dark:bg-gray-800"
>
	<div class="mb-2 flex w-fit max-w-full items-center gap-2 break-all">
		<a href={`${new_link}`}>
			<span id="link" class="text-2xl font-bold tracking-tight text-blue-600 underline">
				{new_link}
			</span>
		</a>
		<button
			type="button"
			id="tooltip-trigger"
			class="rounded border-[2px] border-gray-400 p-2 text-gray-500 hover:border-gray-500 hover:text-gray-600 dark:border-gray-200 dark:text-gray-200 dark:hover:border-gray-400 dark:hover:text-gray-400"
		>
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="size-4">
				{
					/* <!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--> */
				}
				<path
					d="M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"
					fill="currentColor"></path>
			</svg>
		</button>
		<div
			id="tooltip"
			role="tooltip"
			class="tooltip invisible absolute z-10 inline-block rounded-lg border-2 bg-gray-900 px-3 py-2 text-sm font-medium text-white opacity-0 shadow-sm dark:bg-gray-700"
		>
			Copied link!
			<div class="tooltip-arrow" data-popper-arrow></div>
		</div>
	</div>
	<p class="mb-3 font-normal text-gray-700 dark:text-gray-400">Here is your link shortenerðŸ”—</p>
	<a
		href={`${new_link}`}
		target="_blank"
		class="inline-flex items-center rounded-lg bg-blue-700 px-3 py-2 text-center text-sm font-medium text-white hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
	>
		Test it
		<svg
			class="ms-2 h-3.5 w-3.5 rtl:rotate-180"
			aria-hidden="true"
			xmlns="http://www.w3.org/2000/svg"
			fill="none"
			viewBox="0 0 14 10"
		>
			<path
				stroke="currentColor"
				stroke-linecap="round"
				stroke-linejoin="round"
				stroke-width="2"
				d="M1 5h12m0 0L9 1m4 4L9 9"></path>
		</svg>
	</a>
</div>
